---
title:      "라우팅"
date:       2021-04-15
author:     김 성은(plumno1@naver.com)
tags:       [route, routing, ip, network]
---

## Route / Routing 정의

* Routing
  경로를 찾는것  

* Routing protocol
  경로를 찾는데 사용하는 방법  

* Route
  경로 그 자체  
  라우팅 프로토콜을 사용하여 라우팅해서 나온 결과물이 이것  

라우팅에는 출발지와 목적지가 필요함  
따라서 라우팅에 사용하는 장비는 반드시 IP를 구별할 줄 알아야 함  
IP 프로토콜은 3계층이므로 3계층 이상의 장비를 사용해야함  
  
라우팅에는 정적, 동적의 방법이 존재  

* 정적 라우팅
  관리자가 네트워크에 대한 경로 정보를 직접 지정하여 라우팅 하는 방법  
  컴퓨터가 따로 연산하는 것이 없어 속도가 빠름  
  네트워크 변화가 일어날 경우 다시 설정해야 함  

* 동적 라우팅
  라우팅 프로토콜을 사용하여 인접한 라우터 간 변경된 네트워크 정보를 자동으로 교환하여 라우팅  
  초기 설정만 해주면 그 뒤는 알아서 감  
  연산이 필요함  

&nbsp;

## Net Mask

#### Subnetting

* 네트워크
  브로드캐스트 프레임을 전송했을때 수신 할 수 있는 모든 호스트의 집합

네트워크 성능을 향상시키기 위해 자원(네트워크 영억, 호스트 영역)을 효율적으로 분배하는 것  
IP 주소가 한정되어 있으므로 아껴쓰기 위함  
브로드캐스트 영역이 너무 크면 필요없는 브로드캐스트도 받아야하므로 분리하는것이 성능면에서 더 유리함  

&nbsp;

#### Subnet Mask

* CIDR
  Classless Inter-Domain Routing
  사이더라고 읽음  
  클래스 없는 도메인간의 라우팅 기법  
  네트워크 구분을 Class(IP를 A, B, C, D, E로 나누어놓은 그것)화 하지 않고 사용하는 네트워크 구분 체계  

CIDR가 생겨난 후로는 서브넷만 사용하여 넷마스크, 서브넷 마스크 둘의 차이가 거의 없어졌으며 둘이 혼동되어 사용됨  

서브넷 마스크는 IP 주소와 같이 32bit의 2진수로 구성됨  
8bit마다 `.`으로 구분되어있어 형태도 IP와 같음  
형태와 크기가 같은 이유는 IP주소를 AND 연산하기 위함  
서브넷 마스크는 어디가 네트워크 영역이고 어디가 호스트 영역인지를 표현하기 위해 사용되는 것 이므로 1이 중간에 끊어지면 안됨 `11111111.11110101.00000000.00001000` 이런건 안된다는 이야기  

표현시에는 `255.255.255.0`일때 `/24`로 표기도 가능 = 서브넷 마스크의 비트 수

&nbsp;

## 정적 라우팅 설정

* `$ route`  
  라우팅 테이블 확인  
  
* Gateway
  외부 네트워크와 연결하기 위한 장비 보통 라우터가 이 역할을 수행  
  route 쳐서 나온것은 이 장비의 IP주소를 나타냄  
  라우팅할때 이 게이트웨이를 거쳐간 수를 hop count(홉 수)라고 함  
  
* Genmask
  목적지 네트워크의 넷마스크 주소  
  
* Metric
  목적지 네트워크까지의 거리  
  
* Iface
  패킷이 오가는데 사용할 네트워크 Interface  
  
`route`명령으로 추가한 라우팅 정보를 삭제시에는 add 대신 del사용하면 됨  

#### 기본 게이트웨이 추가
  
`route add default gw IP`  
해당 IP로 기본 게이트웨이 설정  
라우팅 테이블에 정보가 없는 모든 패킷은 여기로 나가게 됨  

&nbsp;

#### 네트워크 경로 추가
  
`route add -net IP netmask 넷마스크 gw 게이트웨이 dev 인터페이스명`  
해당 네트워크로 보내는 패킷은 지정한 인터페이스로 나가 해당 게이트웨이를 통하면 된다는 뜻  
  
네트워크 경로나 호스트 경로나 사실상 같은건데 넷마스크가 24비트로 지정시 해당 호스트로 가게 됨  

**route 명령어를 사용하는 경우는 재시작하면 다시 설정해줘야함**  
&nbsp;

### 라우팅 영구 설정

`/etc/sysconfig/network-scripts/route-인터페이스명`  
해당 파일을 열어 
```
ADDRESS숫자=목적지_IP
NETMASK숫자=넷마스크
GATEWAY숫자=게이트웨이_IP
```
입력  
숫자는 0부터 시작하며 라우팅 하나당 숫자 1씩 증가  
  
**저장후에는 반드시 해당 인터페이스를 재시작 해줘야함**  
  
  
default gateway를 영구 저장시에는

`/etc/sysconfig/network` 파일을 열어

```
GATEWAYDEV=인터페이스명
GATEWAY=게이트웨이_IP
```
입력후 저장
  
&nbsp;

